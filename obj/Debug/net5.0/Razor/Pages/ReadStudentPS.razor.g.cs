#pragma checksum "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "24c037cbee73ae328e0c6e1af3b55dad78ff9e2c"
// <auto-generated/>
#pragma warning disable 1591
namespace Students_BlazorServer.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using BlazorForms.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using Microsoft.EntityFrameworkCore;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\tmp\StudentsBlazorServer-EFCore\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/ReadStudentPS/{Page:int}")]
    [Microsoft.AspNetCore.Components.RouteAttribute("/ReadStudentPS")]
    public partial class ReadStudentPS : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<style>\r\n    .curPointer:hover {\r\n        cursor: pointer;\r\n    }\r\n</style>\r\n\r\n");
            __builder.AddMarkupContent(1, "<h1 class=\"bg-info text-white\">Students (Paging & Sorting)</h1>\r\n");
            __builder.OpenElement(2, "table");
            __builder.AddAttribute(3, "class", "table table-sm table-bordered table-striped ");
            __builder.OpenElement(4, "thead");
            __builder.OpenElement(5, "tr");
            __builder.AddMarkupContent(6, "<th>ID</th>\r\n            ");
            __builder.OpenElement(7, "th");
            __builder.AddAttribute(8, "class", "curPointer");
            __builder.AddAttribute(9, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 15 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
                                               () => Sort("Name")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(10, "Name");
#nullable restore
#line 15 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(11, (MarkupString)NameArrow);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(12, "\r\n            ");
            __builder.OpenElement(13, "th");
            __builder.AddAttribute(14, "class", "curPointer");
            __builder.AddAttribute(15, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 16 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
                                               () => Sort("Age")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(16, "Age");
#nullable restore
#line 16 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(17, (MarkupString)AgeArrow);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(18, "\r\n            ");
            __builder.OpenElement(19, "th");
            __builder.AddAttribute(20, "class", "curPointer");
            __builder.AddAttribute(21, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 17 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
                                               () => Sort("DOB")

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(22, "DOB");
#nullable restore
#line 17 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(23, (MarkupString)DOBArrow);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(24, "\r\n            ");
            __builder.AddMarkupContent(25, "<th>Standard</th>\r\n            ");
            __builder.AddMarkupContent(26, "<th>Sex</th>\r\n            ");
            __builder.AddMarkupContent(27, "<th>Email</th>\r\n            ");
            __builder.AddMarkupContent(28, "<th>Terms</th>\r\n            ");
            __builder.AddMarkupContent(29, "<th>School</th>\r\n            ");
            __builder.AddMarkupContent(30, "<th>Location</th>");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(31, "\r\n    ");
            __builder.OpenElement(32, "tbody");
#nullable restore
#line 27 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
         foreach (Student s in Students)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(33, "tr");
            __builder.OpenElement(34, "td");
#nullable restore
#line 30 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(35, s.Id);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(36, "\r\n                ");
            __builder.OpenElement(37, "td");
#nullable restore
#line 31 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(38, s.Name);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(39, "\r\n                ");
            __builder.OpenElement(40, "td");
#nullable restore
#line 32 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(41, s.Age);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\r\n                ");
            __builder.OpenElement(43, "td");
#nullable restore
#line 33 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(44, s.DOB.ToString("dddd, dd MMMM yyyy"));

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(45, "\r\n                ");
            __builder.OpenElement(46, "td");
#nullable restore
#line 34 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(47, s.Standard);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(48, "\r\n                ");
            __builder.OpenElement(49, "td");
#nullable restore
#line 35 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(50, s.Sex);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(51, "\r\n                ");
            __builder.OpenElement(52, "td");
#nullable restore
#line 36 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(53, s.Email);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(54, "\r\n                ");
            __builder.OpenElement(55, "td");
#nullable restore
#line 37 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(56, s.Terms);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(57, "\r\n                ");
            __builder.OpenElement(58, "td");
#nullable restore
#line 38 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(59, s.School_R.Name);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(60, "\r\n                ");
            __builder.OpenElement(61, "td");
#nullable restore
#line 39 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(62, s.Location_R.City);

#line default
#line hidden
#nullable disable
            __builder.AddContent(63, ", ");
#nullable restore
#line 39 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
__builder.AddContent(64, s.Location_R.State);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 41 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(65, "\r\n    ");
            __builder.OpenElement(66, "tfoot");
            __builder.OpenComponent<Students_BlazorServer.Pages.Paging>(67);
            __builder.AddAttribute(68, "PI", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<BlazorForms.Models.PagingInfo>(
#nullable restore
#line 44 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
                    pagingInfo

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(69, "PageClassesEnabled", global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 44 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
                                                    true

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(70, "PageClass", "Paging");
            __builder.AddAttribute(71, "PageClassSelected", "active");
            __builder.CloseComponent();
            __builder.CloseElement();
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 48 "C:\tmp\StudentsBlazorServer-EFCore\Pages\ReadStudentPS.razor"
       
    [Inject]
    public DataContext Context { get; set; }

    public IEnumerable<Student> Students { get; set; } = Enumerable.Empty<Student>();

    [Parameter]
    public int page { get; set; }

    PagingInfo pagingInfo = new PagingInfo();

    protected override void OnParametersSet()
    {
        //CreatePagingInfo();
        GetRecords(sortColumn, sortValue);
    }

    public void CreatePagingInfo()
    {
        var AllStudents = Context.Student.Include(p => p.School_R).Include(p => p.Location_R);

        int PageSize = 1;
        pagingInfo = new PagingInfo();
        page = page == 0 ? 1 : page;
        pagingInfo.CurrentPage = page;
        pagingInfo.TotalItems = AllStudents.Count();
        pagingInfo.ItemsPerPage = PageSize;

        var skip = PageSize * (Convert.ToInt32(page) - 1);
        Students = AllStudents.Skip(skip).Take(PageSize).ToList();
    }
    
    public string sortColumn = "", sortValue = "asc", NameArrow, AgeArrow, DOBArrow;

    void GetRecords(string sortColumn, string sortValue)
    {
        int pageSize = 3;

        pagingInfo = new PagingInfo();
        page = page == 0 ? 1 : page;
        pagingInfo.CurrentPage = page == 0 ? 1 : page;
        pagingInfo.TotalItems = Context.Student.Count();
        pagingInfo.ItemsPerPage = pageSize;

        var skip = pageSize * (Convert.ToInt32(page) - 1);

        var query = Context.Student.Include(p => p.School_R).Include(p => p.Location_R);

        if (sortColumn == "")
            Students = query.Skip(skip).Take(pageSize).ToList();
        else
        {
            if (sortValue == "asc")
            {
                switch (sortColumn)
                {
                    case "Id":
                        Students = query.OrderBy(s => s.Id).Skip(skip).Take(pageSize).ToList();
                        break;
                    case "Name":
                        Students = query.OrderBy(s => s.Name).Skip(skip).Take(pageSize).ToList();
                        break;
                    case "Age":
                        Students = query.OrderBy(s => s.Age).Skip(skip).Take(pageSize).ToList();
                        break;
                    default:
                        Students = query.OrderBy(s => s.Name).Skip(skip).Take(pageSize).ToList();
                        break;
                }
            }
            else
            {
                switch (sortColumn)
                {
                    case "Id":
                        Students = query.OrderByDescending(s => s.Id).Skip(skip).Take(pageSize).ToList();
                        break;
                    case "Name":
                        Students = query.OrderByDescending(s => s.Name).Skip(skip).Take(pageSize).ToList();
                        break;
                    case "Age":
                        Students = query.OrderByDescending(s => s.Age).Skip(skip).Take(pageSize).ToList();
                        break;
                    default:
                        Students = query.OrderByDescending(s => s.Name).Skip(skip).Take(pageSize).ToList();
                        break;
                }
            }
        }
    }

    public void Sort(string column)
    {
        string upArrow = "<img src=\"/Images/up.png\" />";
        string downArrow = "<img src=\"/Images/down.png\" />";

        if (column == sortColumn)
            sortValue = sortValue == "asc" ? "desc" : "asc";
        else
        {
            sortColumn = column;
            sortValue = "asc";
        }

        NameArrow = AgeArrow = DOBArrow = "";
        if (sortColumn == "Name" && sortValue == "asc")
            NameArrow = upArrow;
        else if (sortColumn == "Name" && sortValue == "desc")
            NameArrow = downArrow;

        if (sortColumn == "Age" && sortValue == "asc")
            AgeArrow = upArrow;
        else if (sortColumn == "Age" && sortValue == "desc")
            AgeArrow = downArrow;

        if (sortColumn == "DOB" && sortValue == "asc")
            DOBArrow = upArrow;
        else if (sortColumn == "DOB" && sortValue == "desc")
            DOBArrow = downArrow;

        page = 1;
        GetRecords(sortColumn, sortValue);
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
